<div id="stock-modal" class="modal show" role="dialog" aria-modal="true">
    <div class="modal-content">
        <button class="close" onclick="document.getElementById('stock-modal').remove()">&times;</button>
        <h2 data-i18n="{% if item %}editStock{% else %}addStock{% endif %}">{% if item %}Edit Stock Item{% else %}Add
            Stock Item{% endif %}</h2>

        <form {% if item %}hx-put="/api/stock/{{ item.id }}/set" hx-target="#stock-row-{{ item.id }}"
            hx-swap="outerHTML" {% else %}hx-post="/api/stock/" hx-target="#stock-table-body" hx-swap="beforeend" {%
            endif %} hx-on::after-request="if(event.detail.successful) document.getElementById('stock-modal').remove()">

            <div class="form-row">
                <div class="form-group">
                    <label data-i18n="productName">Item Name</label>
                    <input type="text" name="name" value="{{ item.name if item else '' }}" placeholder="e.g., Flour Bag"
                        required {% if item %}readonly style="background-color: #f0f0f0;" {% endif %}
                        data-i18n="productNamePlaceholder">
                </div>
                <div class="form-group">
                    <label data-i18n="category">Category</label>
                    <select name="category_name" {% if item %}disabled{% endif %}>
                        {% for cat in categories %}
                        <option value="{{ cat }}" {% if item and item.category_name==cat %}selected{% endif %}>{{ cat }}
                        </option>
                        {% endfor %}
                    </select>
                    {% if item %}<input type="hidden" name="category_name" value="{{ item.category_name }}">{% endif %}
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label data-i18n="{% if item %}newQuantity{% else %}initialQuantity{% endif %}">{% if item %}New
                        Quantity{% else %}Initial Quantity{% endif %}</label>
                    <input type="number" step="0.01" name="quantity" value="{{ item.quantity if item else '0.00' }}"
                        placeholder="0.00" required>
                </div>
                <div class="form-group small">
                    <label data-i18n="unit">Unit</label>
                    <select name="unit_name" {% if item %}disabled{% endif %}>
                        <option value="kg" {% if item and item.unit_name=='kg' %}selected{% endif %} data-i18n="kg">kg
                        </option>
                        <option value="g" {% if item and item.unit_name=='g' %}selected{% endif %} data-i18n="g">g
                        </option>
                        <option value="l" {% if item and item.unit_name=='l' %}selected{% endif %} data-i18n="l">l
                        </option>
                        <option value="ml" {% if item and item.unit_name=='ml' %}selected{% endif %} data-i18n="ml">ml
                        </option>
                        <option value="pc" {% if item and item.unit_name=='pc' %}selected{% endif %} data-i18n="pcs">pc
                        </option>
                    </select>
                    {% if item %}<input type="hidden" name="unit_name" value="{{ item.unit_name }}">{% endif %}
                </div>
            </div>
            <div class="form-actions">
                <button type="button" class="btn-secondary" onclick="document.getElementById('stock-modal').remove()"
                    data-i18n="cancel">Cancel</button>
                <button type="submit" class="btn-primary" data-i18n="save">{% if item %}Update Quantity{% else %}Add
                    Item{% endif %}</button>
            </div>
        </form>
    </div>
</div>