# Развертывание Bakery Manager с Docker

Это руководство описывает процесс развертывания приложения Bakery Manager на сервере с использованием Docker и Docker Compose.

## Предварительные требования

На сервере должны быть установлены:
- [Docker](https://docs.docker.com/engine/install/)
- [Docker Compose](https://docs.docker.com/compose/install/) (обычно входит в состав современных версий Docker Plugin: `docker compose`)

## Установка и запуск

1. **Копирование файлов**
   Скопируйте файлы проекта на ваш сервер.

2. **Запуск приложения**
   В корневой папке проекта выполните команду:
   ```bash
   docker-compose up -d --build
   ```
   *Если вы используете новую версию Docker Compose (v2), команда может выглядеть как `docker compose up -d --build`.*

   Эта команда:
   - Соберет Docker-образ приложения.
   - Запустит контейнеры:
     - `app`: Бэкенд приложения (FastAPI).
     - `nginx`: Веб-сервер для обработки внешних запросов.
   - Флаг `-d` запускает контейнеры в фоновом режиме.

3. **Проверка работы**
   Откройте браузер и перейдите по IP-адресу вашего сервера. Приложение должно быть доступно на 80 порту (http://<ВАШ_IP>).

## Управление контейнерами

- **Посмотреть статус контейнеров:**
  ```bash
  docker-compose ps
  ```

- **Посмотреть логи (для отладки):**
  ```bash
  docker-compose logs -f
  ```

- **Остановить приложение:**
  ```bash
  docker-compose down
  ```

- **Перезапустить:**
  ```bash
  docker-compose restart
  ```

- **Обновить приложение (после изменения кода):**
  ```bash
  docker-compose up -d --build
  ```

## Важная информация о данных

- **База данных:** Файл базы данных `bakery_management.db` хранится в папке `./data` в корне проекта на вашем сервере (благодаря настройке `volumes` в `docker-compose.yml`).
- **Сохранность:** Данные **НЕ** исчезнут при остановке или удалении контейнеров, так как они хранятся на хост-машине.
- **Резервное копирование:** Для бэкапа достаточно сохранить копию папки `./data`.

## Конфигурация

### Изменение порта
По умолчанию приложению доступно на 80 порту. Если вы хотите использовать другой порт (например, 8080):
1. Откройте `docker-compose.yml`.
2. В сервисе `nginx` найдите раздел `ports`.
3. Измените `"80:80"` на `"8080:80"`.
4. Перезапустите контейнеры: `docker-compose up -d`.

### Настройка Nginx
Конфигурация Nginx находится в файле `nginx.conf`. Вы можете редактировать этот файл для добавления SSL сертификатов, изменения лимитов загрузки и т.д. После изменений необходимо перезапустить контейнер nginx: `docker-compose restart nginx`.
